import{ag as n}from"./index.ce207a0f.js";import{I as i}from"./Utils.7465a4f2.js";import{a as o}from"./WGLContainer.0d46658c.js";import{h as l,x as a}from"./brushes.f31c87da.js";const c=(t,e)=>t.key.level-e.key.level!=0?t.key.level-e.key.level:t.key.row-e.key.row!=0?t.key.row-e.key.row:t.key.col-e.key.col;class p extends o{constructor(e){super(),this._tileInfoView=e}get requiresDedicatedFBO(){return!1}renderChildren(e){this.sortChildren(c),this.setStencilReference(e),super.renderChildren(e)}createRenderParams(e){const{state:r}=e,s=super.createRenderParams(e);return s.requiredLevel=this._tileInfoView.getClosestInfoForScale(r.scale).level,s.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(r.scale),s}prepareRenderPasses(e){const r=super.prepareRenderPasses(e);return r.push(e.registerRenderPass({name:"stencil",brushes:[l],drawPhase:i.DEBUG|i.MAP|i.HIGHLIGHT,target:()=>this.getStencilTarget()})),n("esri-tiles-debug")&&r.push(e.registerRenderPass({name:"tileInfo",brushes:[a],drawPhase:i.DEBUG,target:()=>this.children})),r}getStencilTarget(){return this.children}updateTransforms(e){for(const r of this.children){const s=this._tileInfoView.getTileResolution(r.key);r.setTransform(e,s)}}setStencilReference(e){let r=1;for(const s of this.children)s.stencilRef=r++}}export{p as o};
