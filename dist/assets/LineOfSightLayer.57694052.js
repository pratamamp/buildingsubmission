import{j as f,e as t,g as s,jY as $,n as v,ws as L,I as b,Q as w,w as p,l as i,jZ as R,ey as h,b5 as z,wt as _,k9 as S,ar as A,wu as M,tC as T,fQ as C,fS as P,M as q}from"./index.46140dee.js";import{f as x,u as m}from"./LineOfSightAnalysisTarget.8a623f81.js";const d=f.ofType(x);let o=class extends L{constructor(e){super(e),this.type="line-of-sight",this.observer=null,this.extent=null,this.nonEditableMessage="Assign an observer location to the analysis to allow editing."}initialize(){this.own(b(()=>this._computeExtent(),e=>{(p(e)||p(e.pending))&&this._set("extent",i(e)?e.extent:null)},w))}get targets(){return this._get("targets")||new d}set targets(e){this._set("targets",R(e,this.targets,d))}get spatialReference(){return i(this.observer)&&i(this.observer.position)?this.observer.position.spatialReference:null}get requiredPropertiesForEditing(){return[h(this.observer,e=>e.position)]}async waitComputeExtent(){const e=this._computeExtent();return i(e)?z(e.pending):null}_computeExtent(){const e=this.spatialReference;if(p(this.observer)||p(this.observer.position)||p(e))return null;const r=l=>T(l.position,l.elevationInfo)==="absolute-height",a=this.observer.position,g=_(a.x,a.y,a.z,a.x,a.y,a.z);for(const l of this.targets)if(i(l.position)){const y=S(l.position,e);if(i(y.pending))return{pending:y.pending,extent:null};if(i(y.geometry)){const{x:O,y:j,z:E}=y.geometry;A(g,[O,j,E])}}const u=M(g,e);return r(this.observer)&&this.targets.every(r)||(u.zmin=null,u.zmax=null),{pending:null,extent:u}}clear(){this.observer=null,this.targets.removeAll()}};t([s({type:["line-of-sight"]})],o.prototype,"type",void 0),t([s({type:m,json:{read:!0,write:!0}})],o.prototype,"observer",void 0),t([s({cast:$,type:d,nonNullable:!0,json:{read:!0,write:!0}})],o.prototype,"targets",null),t([s({value:null,readOnly:!0})],o.prototype,"extent",void 0),t([s({readOnly:!0})],o.prototype,"spatialReference",null),t([s({readOnly:!0})],o.prototype,"requiredPropertiesForEditing",null),t([s({readOnly:!0})],o.prototype,"nonEditableMessage",void 0),o=t([v("esri.analysis.LineOfSightAnalysis")],o);const c=o,F=f.ofType(x);let n=class extends C(P(q)){constructor(e){super(e),this.type="line-of-sight",this.operationalLayerType="LineOfSightLayer",this.analysis=new c,this.opacity=1}initialize(){this.own(b(()=>this.analysis,(e,r)=>{i(r)&&r.parent===this&&(r.parent=null),i(e)&&(e.parent=this)},w))}async load(){return i(this.analysis)&&this.addResolvingPromise(this.analysis.waitComputeExtent()),this}get observer(){return h(this.analysis,e=>e.observer)}set observer(e){h(this.analysis,r=>r.observer=e)}get targets(){return i(this.analysis)?this.analysis.targets:null}set targets(e){h(this.analysis,r=>r.targets=e)}get fullExtent(){return i(this.analysis)?this.analysis.extent:null}get spatialReference(){return i(this.analysis)?this.analysis.spatialReference:null}removeAnalysis(e){this.analysis===e&&(this.analysis=new c)}};t([s({json:{read:!1},readOnly:!0})],n.prototype,"type",void 0),t([s({type:["LineOfSightLayer"]})],n.prototype,"operationalLayerType",void 0),t([s({type:m,json:{read:!0,write:{ignoreOrigin:!0}}})],n.prototype,"observer",null),t([s({type:F,json:{read:!0,write:{ignoreOrigin:!0}}})],n.prototype,"targets",null),t([s({nonNullable:!0,json:{read:!1,write:!1}})],n.prototype,"analysis",void 0),t([s({readOnly:!0})],n.prototype,"fullExtent",null),t([s({readOnly:!0})],n.prototype,"spatialReference",null),t([s({readOnly:!0,json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}}})],n.prototype,"opacity",void 0),t([s({type:["show","hide"]})],n.prototype,"listMode",void 0),n=t([v("esri.layers.LineOfSightLayer")],n);const Q=n;export{Q as default};
