import{no as M,nA as E,nB as R,nC as g,nD as y,l as c,nE as H,w as x,at as d,nF as O,nG as P,hC as C,aq as w,dp as S,a8 as G,kw as v,lB as I,i6 as $,mo as U,nH as b,i4 as h,aX as k,aW as q,aj as A,ak as F,an as B,nI as D,gN as j}from"./index.deeeec5f.js";import{G as _}from"./InteractiveToolBase.c32c093b.js";function z(n,e){return T(n,()=>e)}function en(n){return T(n,e=>e.plane)}function T(n,e){const t=d(),s=d();let a=!1;return r=>{const l=e(r);if(r.action==="start"){const i=E(r.screenStart,R(g.get())),u=y(n.state.camera,i,N);c(u)&&(a=H(l,u,t))}if(!a)return null;const o=E(r.screenEnd,R(g.get())),p=y(n.state.camera,o,N);return x(p)?null:H(l,p,s)?{...r,renderStart:t,renderEnd:s,plane:l,ray:p}:null}}function J(n,e,t,s=null,a=null){let r=null;return l=>{if(l.action==="start"&&(r=n.sceneIntersectionHelper.intersectElevationFromScreen(S(l.screenStart.x,l.screenStart.y),e,t,a),c(r)&&c(s)&&!G(r,r,s))||x(r))return null;const o=n.sceneIntersectionHelper.intersectElevationFromScreen(S(l.screenEnd.x,l.screenEnd.y),e,t,a);return c(o)?c(s)&&!G(o,o,s)?null:{...l,mapStart:r,mapEnd:o}:null}}function K(n,e,t,s=null,a=null){return J(n,t,O(e,n,t),s,a)}function L(n,e,t,s=null,a=null){return K(n,t,P(e),s,a)}function tn(n,e,t,s){const a=e.toMap(n.screenStart,{include:[t]});return c(a)?L(e,t,a,s):null}function W(n,e){const t=V,s=Y,a=v();n.renderCoordsHelper.worldUpAtPosition(e,t);const r=I(a,t,$(s,e,n.state.camera.eye));return I(r,r,t),U(e,r,a)}function rn(n,e,t){let s=null;const a=new _;return a.next(z(n,W(n,e))).next(X(n,e)).next(Q(n,t)).next(r=>{r.mapEnd.x=r.mapStart.x,r.mapEnd.y=r.mapStart.y,s=r}),r=>(s=null,a.execute(r),s)}function X(n,e){const t=d(),s=C(e);n.renderCoordsHelper.worldUpAtPosition(e,t);const a=d(),r=d(),l=o=>($(o,o,e),b(t,o,o),n.viewingMode==="global"&&C(o)*Math.sign(h(t,o))<.001-s&&$(o,k(o,t,.001),e),q(o,o,e),o);return o=>(o.renderStart=l(w(a,o.renderStart)),o.renderEnd=l(w(r,o.renderEnd)),o)}function Q(n,e){const t=n.renderCoordsHelper;return s=>{const a=t.fromRenderCoords(s.renderStart,e),r=t.fromRenderCoords(s.renderEnd,e);return c(a)&&c(r)?{...s,mapStart:a,mapEnd:r}:null}}var m;function sn(n){let e=null;return t=>{switch(t.action){case"start":e=n.disableDisplay();break;case"end":case"cancel":c(e)&&(e.remove(),e=null)}return t}}function an(n,e=null){const t=A(n.state.viewingMode);t.options.selectionMode=!0,t.options.store=F.MIN,t.options.hud=!1;const s=S(),a={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},r=d(),l=B(e,n.spatialReference),o=i=>{n.map.ground&&n.map.ground.opacity<1?a.exclude.add(D):a.exclude.delete(D),n.sceneIntersectionHelper.intersectIntersectorScreen(E(i,s),t,a);const u=t.results.min;let f;if(u.getIntersectionPoint(r))f=u.intersector===j.TERRAIN?m.GROUND:m.OTHER;else{if(!t.results.ground.getIntersectionPoint(r))return null;f=m.GROUND}return{location:n.renderCoordsHelper.fromRenderCoords(r,l),surfaceType:f}};let p;return i=>{if(i.action==="start"){const f=o(i.screenStart);p=c(f)?f.location:null}if(x(p))return null;const u=o(i.screenEnd);return c(u)&&c(u.location)?{...i,mapStart:p,mapEnd:u.location,surfaceType:u.surfaceType}:null}}(function(n){n[n.GROUND=0]="GROUND",n[n.OTHER=1]="OTHER"})(m||(m={}));const V=d(),Y=d(),N=M();export{an as B,z as C,Q as F,rn as G,K as N,L as P,en as T,tn as h,sn as z};
