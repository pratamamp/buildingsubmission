import{C as T,g8 as x,g1 as q,r as z,a6 as O,g9 as g,g0 as V,g5 as I,W,A,gn as l}from"./index.52935b46.js";import{f as L}from"./sphere.fe54e1ae.js";import{c as a,r as j}from"./vectorStacks.a7af424f.js";function R(r){const n=r[0]*r[0]+r[4]*r[4]+r[8]*r[8],t=r[1]*r[1]+r[5]*r[5]+r[9]*r[9],u=r[2]*r[2]+r[6]*r[6]+r[10]*r[10];return Math.sqrt(Math.max(n,t,u))}function S(r,n){const t=Math.sqrt(n[0]*n[0]+n[4]*n[4]+n[8]*n[8]),u=Math.sqrt(n[1]*n[1]+n[5]*n[5]+n[9]*n[9]),e=Math.sqrt(n[2]*n[2]+n[6]*n[6]+n[10]*n[10]);return T(r,t,u,e),r}function k(r,n,t){Math.abs(r[0])>Math.abs(r[1])?T(n,0,1,0):T(n,1,0,0),x(t,r,n),q(n,n),x(n,t,r),q(t,t)}function d(r=E){return[r[0],r[1],r[2],r[3]]}function rr(r=E[0],n=E[1],t=E[2],u=E[3]){return v(r,n,t,u,j.get())}function H(r,n){return v(n[0],n[1],n[2],n[3],r)}function v(r,n,t,u,e=d()){return e[0]=r,e[1]=n,e[2]=t,e[3]=u,e}function J(r,n,t){const u=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],e=Math.abs(u-1)>1e-5&&u>1e-12?1/Math.sqrt(u):1;return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=-(t[0]*r[0]+t[1]*r[1]+t[2]*r[2]),t}function K(r,n,t,u=d()){const e=t[0]-n[0],c=t[1]-n[1],o=t[2]-n[2],N=r[0]-n[0],F=r[1]-n[1],_=r[2]-n[2],s=c*_-o*F,p=o*N-e*_,C=e*F-c*N,P=s*s+p*p+C*C,X=Math.abs(P-1)>1e-5&&P>1e-12?1/Math.sqrt(P):1;return u[0]=s*X,u[1]=p*X,u[2]=C*X,u[3]=-(u[0]*r[0]+u[1]*r[1]+u[2]*r[2]),u}function Q(r,n,t,u,e){if(r.count<3)return!1;r.getVec(t,h);let c=u,o=!1;for(;c<r.count-1&&!o;)r.getVec(c,M),c++,o=!l(h,M);if(!o)return!1;for(c=Math.max(c,e),o=!1;c<r.count&&!o;)r.getVec(c,f),c++,g($,h,M),q($,$),g(m,M,f),q(m,m),o=!l(h,f)&&!l(M,f)&&Math.abs(I($,m))<U;return o?(K(h,M,f,n),!0):(t!==0||u!==1||e!==2)&&Q(r,n,0,1,2)}const U=.99619469809,h=A(),M=A(),f=A(),$=A(),m=A();function nr(r,n,t){return n!==r&&H(r,n),r[3]=-I(r,t),r}function tr(r,n){return n[0]=-r[0],n[1]=-r[1],n[2]=-r[2],n[3]=-r[3],n}function ur(r,n,t,u){return x(f,n,r),J(t,f,u)}function er(r,n,t,u){return b(r,n,g(a.get(),t,n),Z,u)}function or(r,n,t){return!!z(n)&&b(r,n.origin,n.direction,w,t)}function cr(r,n,t){return b(r,n.origin,n.vector,i.NONE,t)}function ir(r,n,t){return b(r,n.origin,n.vector,i.CLAMP,t)}function ar(r,n){return y(r,n)>=0}function fr(r,n){const t=I(r,n.ray.direction),u=-y(r,n.ray.origin);if(t>-1e-6&&t<1e-6)return u>0;const e=u/t;return t>0?e<n.c1&&(n.c1=e):e>n.c0&&(n.c0=e),n.c0<=n.c1}function Ir(r,n,t){const u=O(a.get(),r,-r[3]),e=Y(r,g(a.get(),n,u),a.get());return V(t,e,u),t}function Nr(r,n,t,u){const e=r,c=a.get(),o=a.get();k(e,c,o);const N=g(a.get(),t,n),F=L(c,N),_=L(o,N),s=L(e,N);return T(u,F,_,s)}function Y(r,n,t){const u=O(a.get(),r,I(r,n));return g(t,n,u),t}function y(r,n){return I(r,n)+r[3]}function b(r,n,t,u,e){const c=I(r,t);if(c===0)return!1;let o=-(I(r,n)+r[3])/c;return u&i.CLAMP&&(o=W(o,0,1)),!(!(u&i.INFINITE_MIN)&&o<0||!(u&i.INFINITE_MAX)&&o>1)&&(V(e,n,O(e,t,o)),!0)}function Mr(r){return r}const E=[0,0,1,0];var i;(function(r){r[r.NONE=0]="NONE",r[r.CLAMP=1]="CLAMP",r[r.INFINITE_MIN=4]="INFINITE_MIN",r[r.INFINITE_MAX=8]="INFINITE_MAX"})(i||(i={}));const Z=i.INFINITE_MIN|i.INFINITE_MAX,w=i.INFINITE_MAX;export{H as A,rr as E,v as F,fr as H,Ir as J,Nr as K,nr as L,ur as O,tr as P,ir as U,er as V,y as W,Mr as Z,J as _,S as a,Q as b,K as j,R as l,d as p,or as q,cr as x,ar as z};
